<section id="cases-list-fragment" class="card shadow-sm">
  <div class="card-body">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h3 class="h6 mb-0">Resultado da busca</h3>
      <span class="badge text-bg-light">
        {{ pagination.total }} caso(s)
      </span>
    </div>

    {% if cases %}
      <div class="table-responsive">
        <table class="table table-sm align-middle">
          <thead>
            <tr>
              <th scope="col">Caso</th>
              <th scope="col">Status</th>
              <th scope="col">Atividade mais recente</th>
            </tr>
          </thead>
          <tbody>
            {% for item in cases %}
              <tr>
                <td>
                  <a href="/dashboard/cases/{{ item.case_id }}">
                    {% if item.patient_name and item.agency_record_number %}
                      {{ item.patient_name }} Â· {{ item.agency_record_number }}
                    {% elif item.patient_name %}
                      {{ item.patient_name }}
                    {% elif item.agency_record_number %}
                      Registro {{ item.agency_record_number }}
                    {% else %}
                      Caso {{ item.case_id }}
                    {% endif %}
                  </a>
                  <div class="small text-secondary">{{ item.case_id }}</div>
                </td>
                <td><code>{{ item.status.value }}</code></td>
                <td data-utc-timestamp="{{ item.latest_activity_at.isoformat() }}">{{ item.latest_activity_at.isoformat() }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <p class="text-secondary mb-0">Nenhum caso encontrado para os filtros selecionados.</p>
    {% endif %}

    <nav class="mt-3" aria-label="Paginacao da listagem de casos">
      <ul class="pagination pagination-sm mb-0">
        <li class="page-item {% if not pagination.prev_url %}disabled{% endif %}">
          {% if pagination.prev_url %}
            <a
              class="page-link"
              href="{{ pagination.prev_url }}"
              up-target="#cases-list-fragment"
              up-push-url="true"
            >
              Anterior
            </a>
          {% else %}
            <span class="page-link">Anterior</span>
          {% endif %}
        </li>
        <li class="page-item disabled">
          <span class="page-link">
            Pagina {{ pagination.page }} de {{ pagination.total_pages }}
          </span>
        </li>
        <li class="page-item {% if not pagination.next_url %}disabled{% endif %}">
          {% if pagination.next_url %}
            <a
              class="page-link"
              href="{{ pagination.next_url }}"
              up-target="#cases-list-fragment"
              up-push-url="true"
            >
              Proxima
            </a>
          {% else %}
            <span class="page-link">Proxima</span>
          {% endif %}
        </li>
      </ul>
    </nav>
  </div>
</section>
